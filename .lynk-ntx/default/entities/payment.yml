name: payment

description: ''

key_table: networx_prod.finance.payment_dim

aliases: []

features:
- type: first_last
  name: chargeback_ticket_id
  data_type: string
  asset: chargeback_ticket
  join_name: payments_chargeback
  time_field: null
  filters: []
  options:
    method: last
    sort_by: chargeback_open_date
    field: chargeback_ticket_id
    data_type: null
- type: first_last
  name: chargeback_agent_id
  data_type: string
  asset: chargeback_ticket
  join_name: payments_chargeback
  time_field: null
  filters: []
  options:
    method: last
    sort_by: chargeback_open_date
    field: chargeback_agent_id
    data_type: null
- type: first_last
  name: chargeback_agent_name
  data_type: string
  asset: chargeback_ticket
  join_name: payments_chargeback
  time_field: null
  filters: []
  options:
    method: last
    sort_by: chargeback_open_date
    field: chargeback_agent_name
    data_type: null
- type: first_last
  name: chargeback_agent_opened_id
  data_type: string
  asset: chargeback_ticket
  join_name: payments_chargeback
  time_field: null
  filters: []
  options:
    method: last
    sort_by: chargeback_open_date
    field: chargeback_agent_opened_id
    data_type: null
- type: first_last
  name: chargeback_category_name
  data_type: string
  asset: chargeback_ticket
  join_name: payments_chargeback
  time_field: null
  filters: []
  options:
    method: last
    sort_by: chargeback_open_date
    field: chargeback_category_name
    data_type: null
- type: first_last
  name: chargeback_closed_date
  data_type: string
  asset: chargeback_ticket
  join_name: payments_chargeback
  time_field: null
  filters: []
  options:
    method: last
    sort_by: chargeback_open_date
    field: chargeback_closed_date
    data_type: null
- type: first_last
  name: chargeback_open_date
  data_type: string
  asset: chargeback_ticket
  join_name: payments_chargeback
  time_field: null
  filters: []
  options:
    method: last
    sort_by: chargeback_open_date
    field: chargeback_open_date
    data_type: null
- type: first_last
  name: chargeback_resolution
  data_type: string
  asset: chargeback_ticket
  join_name: payments_chargeback
  time_field: null
  filters: []
  options:
    method: last
    sort_by: chargeback_open_date
    field: chargeback_resolution
    data_type: null
- type: formula
  data_type: string
  name: chargeback_creation
  sql: case when {chargeback_agent_opened_id} = 1 then 'System' when {chargeback_agent_opened_id} > 1 then 'Manual' end
  features:
  - feature: chargeback_agent_opened_id
    alias: null

related_assets:
  networx_prod.finance.payment_dim:
    relationship: one_to_one
    joins:
    - default: true
      type: fields
      fields:
      - source: payment_id
        destination: payment_id
        operator: equal
  networx_src.networx_global.ng_payments:
    relationship: one_to_one
    joins:
    - default: true
      type: fields
      fields:
      - source: payment_id
        destination: payment_id
        operator: equal
  networx_src.networx_global.ng_payment_payload:
    relationship: one_to_one
    joins:
    - default: true
      type: fields
      fields:
      - source: payment_id
        destination: payment_id
        operator: equal
  networx_src.networx_global.ng_payment_brain_tree:
    relationship: one_to_one
    joins:
    - default: true
      type: fields
      fields:
      - source: payment_id
        destination: payment_id
        operator: equal
