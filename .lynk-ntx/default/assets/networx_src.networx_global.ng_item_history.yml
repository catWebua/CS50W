asset: networx_src.networx_global.ng_item_history

business_keys: []

description: ''

measures:
- name: item_history_agent
  description: ''
  sql: case when {user_type} = 'agent' then {user_id} end
- name: first_client_note_at
  description: ''
  sql: min(case when {history_type_id} = 138 then {created_at} end)
- name: last_client_note_at
  description: ''
  sql: max(case when {history_type_id} = 138 then {created_at} end)
- name: client_note_count
  description: ''
  sql: sum(case when {history_type_id} = 138 then 1 else 0 end)
- name: first_client_intro_at
  description: ''
  sql: min(case when {history_type_id} in (90, 179, 188) then {created_at} end)
- name: last_client_intro_at
  description: ''
  sql: max(case when {history_type_id} in (90, 179, 188) then {created_at} end)
- name: client_intro_count
  description: ''
  sql: sum(case when {history_type_id} in (90, 179, 188) then 1 else 0 end)
- name: first_client_check_in_at
  description: ''
  sql: min(case when {history_type_id} = 87 then {created_at} end)
- name: last_client_check_in_at
  description: ''
  sql: max(case when {history_type_id} = 87 then {created_at} end)
- name: client_check_in_count
  description: ''
  sql: sum(case when {history_type_id} = 87 then 1 else 0 end)
- name: lcr_requested_by
  description: ''
  sql: case when {history_type_id} = 27 and {user_table_id} = 30 then 'agent'
       when {history_type_id} = 27 and {user_table_id} = 94 then 'client'
       when {history_type_id} = 27 and {user_table_id} = 18 then 'homeowner' end
